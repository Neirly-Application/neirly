// src/models/ApiKey.js
const mongoose = require('mongoose');
const { Schema } = mongoose;

const apiKeySchema = new Schema({
  key:        { type: String, required: true, unique: true },  // visibile al frontend
  hashedKey:  { type: String, required: true, unique: true },  // per verifica lato server
  description:{ type: String, required: true },
  owner:      { type: Schema.Types.ObjectId, ref: 'User', required: true },
  status:     { type: String, enum:['active','revoked'], default:'active' },
  permissions:{ type: [String], default:['read:profile'] },
  createdAt:  { type: Date, default: Date.now },
  lastUsedAt: { type: Date, default: null }
});

module.exports = mongoose.model('ApiKey', apiKeySchema);
